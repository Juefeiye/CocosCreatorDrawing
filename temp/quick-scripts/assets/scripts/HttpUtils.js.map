{"version":3,"sources":["HttpUtils.js"],"names":["httpUtils","cc","Class","extends","Component","properties","statics","instance","onLoad","httpGets","url","callback","xhr","loader","getXMLHttpRequest","onreadystatechange","readyState","status","respone","responseText","open","sys","isNative","setRequestHeader","timeout","send","httpPost","params","log","getInstance","module","exports"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIA,YAAYC,GAAGC,KAAH,CAAS;AACrBC,aAASF,GAAGG,SADS;;AAGrBC,gBAAY,EAHS;;AAMrBC,aAAS;AACLC,kBAAU;AADL,KANY;;AAUrB;AACAC,YAAQ,kBAAY,CACnB,CAZoB;;AAcrBC,cAAU,kBAAUC,GAAV,EAAeC,QAAf,EAAyB;AAC/B,YAAIC,MAAMX,GAAGY,MAAH,CAAUC,iBAAV,EAAV;AACAF,YAAIG,kBAAJ,GAAyB,YAAY;AACjC,gBAAIH,IAAII,UAAJ,KAAmB,CAAnB,IAAyBJ,IAAIK,MAAJ,IAAc,GAAd,IAAqBL,IAAIK,MAAJ,GAAa,GAA/D,EAAqE;AACjE,oBAAIC,UAAUN,IAAIO,YAAlB;AACAR,yBAASO,OAAT;AACH;AACJ,SALD;AAMAN,YAAIQ,IAAJ,CAAS,KAAT,EAAgBV,GAAhB,EAAqB,IAArB;AACA,YAAIT,GAAGoB,GAAH,CAAOC,QAAX,EAAqB;AACjBV,gBAAIW,gBAAJ,CAAqB,iBAArB,EAAwC,cAAxC;AACH;;AAED;AACA;AACAX,YAAIY,OAAJ,GAAc,KAAd,CAf+B,CAeX;;AAEpBZ,YAAIa,IAAJ;AACH,KAhCoB;;AAkCrBC,cAAU,kBAAUhB,GAAV,EAAeiB,MAAf,EAAuBhB,QAAvB,EAAiC;AACvC,YAAIC,MAAMX,GAAGY,MAAH,CAAUC,iBAAV,EAAV;AACAF,YAAIG,kBAAJ,GAAyB,YAAY;AACjCd,eAAG2B,GAAH,CAAO,oBAAkBhB,IAAII,UAAtB,GAAiC,eAAjC,GAAiDJ,IAAIK,MAA5D;AACA,gBAAIL,IAAII,UAAJ,KAAmB,CAAnB,IAAyBJ,IAAIK,MAAJ,IAAc,GAAd,IAAqBL,IAAIK,MAAJ,GAAa,GAA/D,EAAqE;AACjE,oBAAIC,UAAUN,IAAIO,YAAlB;AACAR,yBAASO,OAAT;AACH,aAHD,MAGK;AACCP,yBAAS,CAAC,CAAV;AACL;AACJ,SARD;AASAC,YAAIQ,IAAJ,CAAS,MAAT,EAAiBV,GAAjB,EAAsB,IAAtB;AACA,YAAIT,GAAGoB,GAAH,CAAOC,QAAX,EAAqB;AACjBV,gBAAIW,gBAAJ,CAAqB,iBAArB,EAAwC,cAAxC;AACH;;AAED;AACA;AACAX,YAAIY,OAAJ,GAAc,IAAd,CAlBuC,CAkBpB;;AAEnBZ,YAAIa,IAAJ,CAASE,MAAT;AACH;AAvDoB,CAAT,CAAhB;;AA0DA3B,UAAU6B,WAAV,GAAwB,YAAY;AAChC,QAAI7B,UAAUO,QAAV,IAAsB,IAA1B,EAAgC;AAC5BP,kBAAUO,QAAV,GAAqB,IAAIP,SAAJ,EAArB;AACH;AACD,WAAOA,UAAUO,QAAjB;AACH,CALD;;AAOAuB,OAAOC,OAAP,GAAiB/B,SAAjB","file":"HttpUtils.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\nvar httpUtils = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n    },\n\n    statics: {\n        instance: null\n    },\n\n    // use this for initialization\n    onLoad: function () {\n    },\n\n    httpGets: function (url, callback) {\n        var xhr = cc.loader.getXMLHttpRequest();\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\n                var respone = xhr.responseText;\n                callback(respone);\n            }\n        };\n        xhr.open(\"GET\", url, true);\n        if (cc.sys.isNative) {\n            xhr.setRequestHeader(\"Accept-Encoding\", \"gzip,deflate\");\n        }\n\n        // note: In Internet Explorer, the timeout property may be set only after calling the open()\n        // method and before calling the send() method.\n        xhr.timeout = 20000;// 20 seconds for timeout\n\n        xhr.send();\n    },\n\n    httpPost: function (url, params, callback) {\n        var xhr = cc.loader.getXMLHttpRequest();\n        xhr.onreadystatechange = function () {\n            cc.log('xhr.readyState='+xhr.readyState+'  xhr.status='+xhr.status);\n            if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\n                var respone = xhr.responseText;\n                callback(respone);\n            }else{\n                  callback(-1);\n            }\n        };\n        xhr.open(\"POST\", url, true);\n        if (cc.sys.isNative) {\n            xhr.setRequestHeader(\"Accept-Encoding\", \"gzip,deflate\");\n        }\n\n        // note: In Internet Explorer, the timeout property may be set only after calling the open()\n        // method and before calling the send() method.\n        xhr.timeout = 5000;// 5 seconds for timeout\n\n        xhr.send(params);\n    }\n});\n\nhttpUtils.getInstance = function () {\n    if (httpUtils.instance == null) {\n        httpUtils.instance = new httpUtils();\n    }\n    return httpUtils.instance;\n};\n\nmodule.exports = httpUtils;\n\n"]}